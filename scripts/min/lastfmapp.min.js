var lastFmApp={};lastFmApp.apikey="51657a939714920b12e608782d9961d0",lastFmApp.tracks=[],lastFmApp.months={Jan:0,Feb:0,Mar:0,Apr:0,May:0,Jun:0,Jul:0,Aug:0,Sep:0,Oct:0,Nov:0,Dec:0},lastFmApp.totalPages=0,lastFmApp.totalTracks=0,lastFmApp.startDate="1388534400",lastFmApp.endDate="1420070399",lastFmApp.artist="",lastFmApp.user="",lastFmApp.init=function(){$("#submit").on("click",function(){lastFmApp.reset(),lastFmApp.user=$("#userName").val(),lastFmApp.artist=$("#artistName").val();var t="1388534400",a="1420070399";$(".year-link:first").css({color:"#B42024","text-decoration":"none"}),$(".year-link").hover("text-decoration","underline"),lastFmApp.getTracks(lastFmApp.artist,lastFmApp.user,t,a)})},lastFmApp.reset=function(){lastFmApp.tracks.length=0,lastFmApp.months={Jan:0,Feb:0,Mar:0,Apr:0,May:0,Jun:0,Jul:0,Aug:0,Sep:0,Oct:0,Nov:0,Dec:0},$(".year-link").css({color:"#FFF","text-decoration":"none"}),$(".year-link").hover("text-decoration","underline")},lastFmApp.getTracks=function(t,a,s,e){$.ajax({url:"http://ws.audioscrobbler.com/2.0/",type:"GET",dataType:"jsonp",data:{method:"user.getartisttracks",user:a,artist:t,startTimestamp:s,endTimestamp:e,api_key:lastFmApp.apikey,format:"json"},success:function(s){if("undefined"==typeof s.artisttracks)swal({title:"No results!",text:"Check that the username and artist name are spelled correctly.",type:"error"});else if("undefined"==typeof s.artisttracks["@attr"])swal({title:"No results for that year!",text:"Try choosing another date.",type:"error"});else{lastFmApp.totalTracks=s.artisttracks["@attr"].total,lastFmApp.totalPages=s.artisttracks["@attr"].totalPages;for(var e=0;e<s.artisttracks.track.length;e++)lastFmApp.tracks.push(s.artisttracks.track[e]);1==lastFmApp.totalPages?lastFmApp.getDate(lastFmApp.tracks):lastFmApp.getPages(s,t,a)}}})},lastFmApp.getPages=function(t,a,s){for(var e=2;e<=lastFmApp.totalPages;e++)$.ajax({url:"http://ws.audioscrobbler.com/2.0/",type:"GET",dataType:"jsonp",data:{method:"user.getartisttracks",user:s,artist:a,startTimestamp:lastFmApp.startDate,endTimestamp:lastFmApp.endDate,page:e.toString(),api_key:lastFmApp.apikey,format:"json"},success:function(t){for(var a=0;a<t.artisttracks.track.length;a++)lastFmApp.tracks.push(t.artisttracks.track[a]);lastFmApp.tracks.length==lastFmApp.totalTracks&&lastFmApp.getDate(lastFmApp.tracks)}})},lastFmApp.getDate=function(t){for(var a=0;a<lastFmApp.tracks.length;a++)"Jan"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Jan++:"Feb"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Feb++:"Mar"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Mar++:"Apr"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Apr++:"May"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.May++:"Jun"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Jun++:"Jul"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Jul++:"Aug"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Aug++:"Sep"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Sep++:"Oct"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Oct++:"Nov"==t[a].date["#text"].slice(-15,-12)?lastFmApp.months.Nov++:"Dec"==t[a].date["#text"].slice(-15,-12)&&lastFmApp.months.Dec++;lastFmChart()},$(".year-link").on("click",function(){lastFmApp.reset(),$(".year-link:first").css("color","#FFF");var t=$(this).text();$(this).css({color:"#B42024","text-decoration":"none"}),$(this).hover("text-decoration","underline"),lastFmApp.changeYear(t)}),lastFmApp.changeYear=function(t){"2014"==t?(lastFmApp.startDate="1388534400",lastFmApp.endDate="1420070399"):"2013"==t?(lastFmApp.startDate="1356998400",lastFmApp.endDate="1388534399"):"2012"==t?(lastFmApp.startDate="1325376000",lastFmApp.endDate="1356998399"):"2011"==t?(lastFmApp.startDate="1293840000",lastFmApp.endDate="1325375999"):"2010"==t?(lastFmApp.startDate="1262304000",lastFmApp.endDate="1293839999"):"2009"==t?(lastFmApp.startDate="1230768000",lastFmApp.endDate="1262303999"):"2008"==t?(lastFmApp.startDate="1199145600",lastFmApp.endDate="1230767999"):"2007"==t&&(lastFmApp.startDate="1167609600",lastFmApp.endDate="1199145599"),lastFmApp.getTracks(lastFmApp.artist,lastFmApp.user,lastFmApp.startDate,lastFmApp.endDate)},$body=$("body"),$(document).on({ajaxStart:function(){$body.addClass("loading")},ajaxStop:function(){$body.removeClass("loading")}}),$(document).ready(function(){lastFmApp.init()});